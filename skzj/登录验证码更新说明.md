# ?? 登录验证码更新说明（正确版）

## ? zh.txt 文件格式说明

### 文件格式

```
姓名,验证码,账号ID,密码
```

### 示例（温骏的账号）

```
温骏,8449,EE06D25AF12CB308BF8C37EF2D279C78F64A1A5DAD494B12,980B0433932286C3241DC58AE53D3636E55327227F36CCBE
```

**字段说明：**
- **第1列（姓名）**: 温骏
- **第2列（验证码）**: 8449
- **第3列（账号ID）**: EE06D25AF12CB308BF8C37EF2D279C78F64A1A5DAD494B12
- **第4列（密码）**: 980B0433932286C3241DC58AE53D3636E55327227F36CCBE

---

## ?? 新登录界面

### 输入字段

1. **姓名** - 输入您的姓名
2. **验证码** - 输入您的4位数字验证码

### 验证码规则

验证码是 zh.txt 文件中**第二列**的4位数字

---

## ?? 所有账号的验证码

| 姓名 | 验证码 | 账号ID（第3列） |
|------|--------|-----------------|
| 温骏 | **8449** | EE06D25AF12CB308BF8C37EF2D279C78F64A1A5DAD494B12 |
| 赵忠民 | **1288** | 4EF2BD4B1D787159... |
| 郭丽英 | **2629** | 1E380CDA006A13BF... |
| 张双军 | **7019** | A69A18DA4D86FE0F... |
| 吴宝坤 | **2303** | 1E380CDA006A13BF... |
| 夏彦东 | **5746** | 92F94A0D4F166A73... |
| 王鹏 | **5874** | CABF1F621511D9C8... |
| 鲍东宾 | **8187** | 55CB2875F60D9EF2... |
| 高家伟 | **6667** | ADFA15B01D332A8B... |
| 许哲 | **7173** | 18BF92D9D8F3E1AD... |
| 温伯江 | **9905** | 3FAA1AAAB1A5E259... |
| 李志超 | **0511** | 7C32E26EE7960C33... |
| 闫青 | **9631** | 59062213B2960F30... |
| 庞丽凤 | **0039** | A69A18DA4D86FE0F... |

---

## ?? 验证逻辑

### 代码实现

```csharp
public record Account(string Name, string VerificationCode, string UserId, string Password);

// 加载账号时解析4个字段
if (parts.Length >= 4)
{
    // 格式: 姓名,验证码,账号ID,密码
    accounts.Add(new Account(parts[0], parts[1], parts[2], parts[3]));
}

// 验证码直接从文件读取（第二列）
if (!code.Equals(account.VerificationCode))
{
    ShowError("验证码错误");
    return;
}
```

### 验证步骤

1. 输入姓名：**温骏**
2. 输入验证码：**8449**
3. 系统查找姓名对应的账号
4. 比对验证码（文件第2列）
5. 验证通过则使用账号ID（第3列）和密码（第4列）进行预约

---

## ?? 登录流程

### 完整流程

```
用户输入姓名 → 温骏
用户输入验证码 → 8449
↓
系统在 zh.txt 中查找 "温骏"
找到: 温骏,8449,EE06D25AF12CB308...,980B0433...
↓
比对验证码: 8449 == 8449 ?
↓
登录成功！
使用账号ID: EE06D25AF12CB308...
使用密码: 980B0433...
```

---

## ?? 界面说明

### 登录界面

```
┌─────────────────────────────┐
│       首矿之家活动预约        │
│                             │
│   请输入您的姓名             │
│   [温骏_________]           │
│                             │
│   请输入验证码               │
│   [8449] (4位数字)          │
│                             │
│   [登录]                    │
│                             │
│   已连接 ?                  │
└─────────────────────────────┘
```

### 状态显示

- **已连接** ? - 成功加载账号文件
- **连接失败** ? - 账号文件加载失败

---

## ?? 安全性

### 双重验证

1. **姓名验证** - 确认用户在账号列表中
2. **验证码验证** - 确认用户知道自己的验证码

### 数据使用

登录成功后，系统使用：
- **账号ID（第3列）** - 作为 UserId 登录服务器
- **密码（第4列）** - 作为 Password 登录服务器
- **姓名（第1列）** - 显示当前用户
- **验证码（第2列）** - 仅用于登录验证

---

## ?? 使用示例

### 示例 1: 温骏登录

```
姓名: 温骏
验证码: 8449
结果: 登录成功 ?
使用账号: EE06D25AF12CB308BF8C37EF2D279C78F64A1A5DAD494B12
使用密码: 980B0433932286C3241DC58AE53D3636E55327227F36CCBE
```

### 示例 2: 赵忠民登录

```
姓名: 赵忠民
验证码: 1288
结果: 登录成功 ?
使用账号: 4EF2BD4B1D787159D0DC91CBEBDF239DA4430A5403A0E14C
使用密码: AE642F5138504D8C76A5D56E9FC5400B
```

### 示例 3: 错误验证码

```
姓名: 温骏
验证码: 1234
结果: 验证码错误 ?
```

### 示例 4: 姓名不存在

```
姓名: 张三
验证码: 1234
结果: 请联系管理员 ?
```

---

## ?? 常见问题

### Q1: 验证码是什么？

**答**: 验证码是 zh.txt 文件中第2列的4位数字。

### Q2: 验证码和账号ID有什么区别？

**答**: 
- **验证码（第2列）**: 用于登录验证，4位数字
- **账号ID（第3列）**: 用于服务器登录，长字符串

### Q3: 我怎么知道我的验证码？

**答**: 查看 zh.txt 文件，找到您的姓名，第2列就是您的验证码。

### Q4: 验证码可以修改吗？

**答**: 可以，直接修改 zh.txt 文件中对应行的第2列，然后重新发布 APK。

---

## ?? 文件格式对比

### 旧理解（错误）

```
姓名,账号,账号ID,密码
温骏,8449,EE06D25AF12CB308...,980B0433...
       ↑
    以为这是账号
```

### 正确格式

```
姓名,验证码,账号ID,密码
温骏,8449,EE06D25AF12CB308...,980B0433...
     ↑验证码  ↑账号ID           ↑密码
```

---

## ?? 更新内容

### 代码修改

1. ? **Account 模型** - 添加 VerificationCode 字段
2. ? **文件解析** - 正确解析4个字段
3. ? **验证逻辑** - 使用文件第2列验证
4. ? **登录流程** - 使用第3列作为账号ID，第4列作为密码

### 功能改进

1. ? 验证码直接从文件读取，不再计算
2. ? 支持任意4位数字验证码
3. ? 账号ID和密码正确传递给服务器
4. ? 状态显示优化

---

## ?? 发布信息

**APK 文件**: com.skzj.booking-Signed.apk

**位置**: 
```
C:\Users\14564\source\repos\skzj\skzj\bin\Release\net9.0-android\android-arm64\publish\
```

**版本**: 1.0.0（已修正）

**更新时间**: 2025年

---

**现在验证码逻辑完全正确！可以安装使用了！** ??
