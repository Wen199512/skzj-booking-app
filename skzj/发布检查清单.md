# ?? 版本发布检查清单

## 发布前检查

### 代码质量

- [ ] 所有功能测试通过
- [ ] 无已知严重 Bug
- [ ] 代码已提交到 Git
- [ ] 编译无错误

### 版本信息

- [ ] 更新 `skzj.csproj` 中的版本号
  ```xml
  <ApplicationDisplayVersion>X.X.X</ApplicationDisplayVersion>
  <ApplicationVersion>X</ApplicationVersion>
  ```
- [ ] 准备更新日志
- [ ] 确认版本号遵循语义化版本规范

### 敏感信息

- [ ] 确认 zh.txt 处理方式（内嵌或排除）
- [ ] 检查是否有敏感信息在代码中
- [ ] 验证 .gitignore 配置正确

## 发布步骤

### 1. 本地构建测试

```cmd
clean-build-publish.bat
```

- [ ] 构建成功
- [ ] APK 文件生成
- [ ] 在真机上测试安装
- [ ] 测试所有核心功能

### 2. 提交代码

```bash
git add .
git commit -m "release: vX.X.X - 更新说明"
```

- [ ] 代码已提交
- [ ] 提交信息清晰

### 3. 创建版本标签

```bash
git tag -a vX.X.X -m "Release vX.X.X: 详细说明"
```

- [ ] 标签已创建
- [ ] 标签信息完整

### 4. 推送到 GitHub

```bash
git push origin main
git push origin vX.X.X
```

- [ ] 代码推送成功
- [ ] 标签推送成功

### 5. 监控自动构建

访问: https://github.com/YOUR_USERNAME/skzj-booking-app/actions

- [ ] GitHub Actions 开始运行
- [ ] 构建无错误
- [ ] APK 上传成功
- [ ] Release 创建成功

### 6. 验证发布

访问: https://github.com/YOUR_USERNAME/skzj-booking-app/releases

- [ ] Release 页面正常显示
- [ ] APK 可以下载
- [ ] 版本号正确
- [ ] 更新说明完整

### 7. 测试更新

- [ ] 下载 GitHub 上的 APK
- [ ] 安装到测试设备
- [ ] 验证应用更新检测功能
- [ ] 测试核心功能正常

## 发布后工作

### 通知用户

- [ ] 通知相关用户有新版本
- [ ] 提供下载链接
- [ ] 说明更新内容

### 文档更新

- [ ] 更新 README.md
- [ ] 更新更新日志
- [ ] 记录已知问题（如有）

### 监控反馈

- [ ] 收集用户反馈
- [ ] 记录新问题
- [ ] 计划下一个版本

## 快速发布命令

使用自动化脚本（推荐）：

```cmd
github-release.bat
```

或手动执行：

```bash
# 设置版本号
set VERSION=1.0.1

# 提交
git add .
git commit -m "release: v%VERSION%"

# 标签
git tag -a v%VERSION% -m "Release v%VERSION%"

# 推送
git push origin main --tags
```

## 回滚方案

### 如果发布出现问题

1. **删除错误的 Release**
   - 访问 GitHub Releases 页面
   - 删除错误的 Release

2. **删除错误的标签**
   ```bash
   # 本地删除
   git tag -d vX.X.X
   
   # 远程删除
   git push origin :refs/tags/vX.X.X
   ```

3. **修复问题**
   - 修复代码
   - 重新发布

### 紧急修复流程

如果已发布版本有严重问题：

1. 立即创建 hotfix 分支
   ```bash
   git checkout -b hotfix/vX.X.X+1
   ```

2. 修复问题

3. 快速发布新版本
   ```bash
   # 递增修订版本号
   # 例如 1.0.1 -> 1.0.2
   ```

## 版本命名规范

### 语义化版本

`主版本.次版本.修订版本`

- **主版本**: 重大变更（1.0.0 -> 2.0.0）
- **次版本**: 新功能（1.0.0 -> 1.1.0）
- **修订版本**: Bug 修复（1.0.0 -> 1.0.1）

### 示例

- `v1.0.0` - 首次发布
- `v1.0.1` - 修复 Bug
- `v1.1.0` - 添加新功能
- `v2.0.0` - 重大架构变更

## 常见问题

### Q: GitHub Actions 构建失败？

检查：
- [ ] .NET 版本是否正确
- [ ] 工作流文件语法
- [ ] 依赖是否可用
- [ ] 查看 Actions 日志

### Q: APK 无法下载？

检查：
- [ ] Release 是否发布成功
- [ ] Assets 是否上传
- [ ] 文件权限设置

### Q: 版本号冲突？

解决方法：
```bash
# 删除本地标签
git tag -d vX.X.X

# 删除远程标签
git push origin :refs/tags/vX.X.X

# 重新创建正确的标签
```

---

**记得每次发布前仔细检查以上清单！** ?
